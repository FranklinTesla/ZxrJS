{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap f7f70e9f40a8fb14bbda","webpack:///./src/index.js","webpack:///./src/zxr.js","webpack:///./src/initComponent.js","webpack:///./src/watcher.js","webpack:///./src/dep.js","webpack:///./src/dom.js","webpack:///./src/expression.js","webpack:///./src/var/toString.js","webpack:///./src/var/regEscape.js"],"names":["module","exports","Zxr","options","Error","el","document","querySelector","$data","data","_watchers","__defineReactive","$compile","initComponent","trimToken","str","replace","prototype","_compileSingleNode","elem","nodeValue","textContent","value","rule","matchResult","match","watchers","keys","forEach","item","push","i","len","length","exp","RegExp","result","updateNode","attrs","attributes","childNodes","parseFn","arrayLike","nodeType","defineSingleReactive","obj","Object","key","val","dep","defineProperty","get","target","depend","set","newVal","notify","uid","Watcher","vm","id","lastValue","addSub","Dep","subs","sub","removeSub","$remove","addDep","l","update","Dom","name","ownerElement","keySplit","split","resultStr","eval","toString","call"],"mappings":"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","file":"vue.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Vue\"] = factory();\n\telse\n\t\troot[\"Vue\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f7f70e9f40a8fb14bbda","import {Zxr} from './zxr';\nimport {initComponent} from './initComponent';\ninitComponent(Zxr);\n// 全局出口\nmodule.exports = Zxr;\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/**\n * Zxr实例构造函数\n * @param options\n * @constructor\n */\nfunction Zxr(options) {\n    if (options == null) throw new Error('an object param named must be pass in!');\n    let el = options.el;\n    el = document.querySelector(el);\n    this.$data = options.data;\n    this._watchers = [];\n    // 添加响应\n    this.__defineReactive();\n    // 编译模板\n    this.$compile(el);\n}\nexport {Zxr};\n\n\n// WEBPACK FOOTER //\n// ./src/zxr.js","import {Watcher} from './watcher';\r\nimport {Dep} from './dep';\r\nimport {Dom} from './dom';\r\nimport objToString from './var/toString';\r\nimport regEscape from './var/regEscape';\r\nimport getExpVal from './expression';\r\nexport function initComponent(Zxr) {\r\n    function trimToken(str) {\r\n        return str.replace(/\\s*\\{\\s*\\{\\s*/g, '')\r\n            .replace(/\\s*}\\s*}\\s*/g, '');\r\n    };\r\n    /**\r\n     * 编译具体节点\r\n     * 将文本节点和属性节点中的{{xx}}替换为实际的值\r\n     */\r\n    Zxr.prototype._compileSingleNode = function(elem) {\r\n        let nodeValue = elem.textContent || elem.value,\r\n            rule = /\\{\\s*\\{\\s*([\\w.]+)\\s*}\\s*}/g,\r\n            matchResult = nodeValue.match(rule),\r\n            data = this.$data,\r\n            watchers = [];\r\n\r\n        if (!matchResult) return;\r\n        let keys = [];\r\n\r\n        matchResult.forEach(function(item) {\r\n            keys.push(trimToken(item));\r\n        });\r\n\r\n        for (let i = 0,len = keys.length;i < len;i++) {\r\n            let exp = keys[i],\r\n                rule = new RegExp('\\\\{\\\\s*\\\\{\\\\s*('+regEscape(exp)+'+)\\\\s*}\\\\s*}'),\r\n                result = getExpVal(data, exp);\r\n            // 对所有插值语句创建watcher\r\n            watchers.push(new Watcher(this, elem, exp));\r\n            nodeValue = nodeValue.replace(rule, result);\r\n        }\r\n        // 更新节点\r\n        Dom.updateNode(elem, nodeValue);\r\n    };\r\n    /**\r\n     * 节点遍历处理函数\r\n     */\r\n    Zxr.prototype.$compile = function(el) {\r\n        let attrs = el.attributes,\r\n            childNodes = el.childNodes;\r\n        let parseFn = (arrayLike) => {\r\n            for(let i = 0,len = arrayLike.length;i < len;i++) {\r\n                let item = arrayLike[i];\r\n                // 递归处理element节点和document节点\r\n                if (item.nodeType === 1 || item.nodeType === 9) {\r\n                    this.$compile(item);\r\n                } else {\r\n                    this._compileSingleNode(item);\r\n                }\r\n            }\r\n        };\r\n        // 遍历属性处理属性插值\r\n        if (attrs.length > 0) parseFn(attrs);\r\n        // 遍历子节点，处理节点插值\r\n        if (childNodes.length > 0) parseFn(childNodes);\r\n    };\r\n    /**\r\n     * 为data对象添加响应\r\n     */\r\n    Zxr.prototype.__defineReactive = function() {\r\n        let data = this.$data;\r\n        let defineSingleReactive = function(obj) {\r\n            let keys = Object.keys(obj);\r\n            for (let i = 0,len = keys.length;i < len;i++) {\r\n                let key = keys[i],\r\n                    val = obj[key],\r\n                    dep = new Dep();\r\n                Object.defineProperty(obj, key ,{\r\n                    get: function() {\r\n                        if (Dep.target) {\r\n                            dep.depend();\r\n                        }\r\n                        return val;\r\n                    },\r\n                    set: function(newVal) {\r\n                        if (newVal === val) {\r\n                            return;\r\n                        }\r\n                        dep.notify(newVal);\r\n                    }\r\n                });\r\n                if (objToString(val) === '[object Object]') {\r\n                    defineSingleReactive(val);\r\n                }\r\n            }\r\n        };\r\n        defineSingleReactive(data);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/initComponent.js","import {Dep} from './dep';\r\nimport {Dom} from './dom';\r\nimport getExpVal from './expression';\r\nlet uid = 0;\r\nexport class Watcher {\r\n    constructor(vm, elem, exp) {\r\n        this.id = uid++;\r\n        this.exp = exp;\r\n        this.vm = vm;\r\n        this.elem = elem;\r\n        vm._watchers.push(this);\r\n        Dep.target = this;\r\n        this.value = getExpVal(vm.$data, exp);\r\n        Dep.target = null;\r\n    }\r\n    update(newVal) {\r\n        let lastValue = this.value;\r\n        if (newVal === lastValue) {\r\n            return;\r\n        }\r\n        // 处理文本节点\r\n        let elem = this.elem,\r\n            nodeValue = elem.textContent;\r\n        this.value = newVal;\r\n        nodeValue = nodeValue.replace(lastValue, newVal);\r\n        Dom.updateNode(elem, nodeValue);\r\n    }\r\n    addDep(dep){\r\n        dep.addSub(this);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/watcher.js","let uid = 0;\nexport class Dep {\n    constructor() {\n        this.id = uid++;\n        this.subs = [];\n    }\n}\n\nDep.target = null;\n/**\n * Add a directive subscriber.\n *\n * @param {Directive} sub\n */\n\nDep.prototype.addSub = function (sub) {\n    this.subs.push(sub)\n}\n\n/**\n * Remove a directive subscriber.\n *\n * @param {Directive} sub\n */\n\nDep.prototype.removeSub = function (sub) {\n    this.subs.$remove(sub)\n}\n\n/**\n * Add self as a dependency to the target watcher.\n */\n\nDep.prototype.depend = function () {\n    Dep.target.addDep(this)\n}\n\n/**\n * Notify all subscribers of a new value.\n */\n\nDep.prototype.notify = function (newVal) {\n    // stablize the subscriber list first\n    var subs = this.subs\n    for (var i = 0, l = subs.length; i < l; i++) {\n        subs[i].update(newVal);\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/dep.js","export let Dom = {\n    updateNode: (elem, newVal) => {\n        let nodeValue = elem.textContent;\n        if (nodeValue === newVal) {\n            return elem;\n        }\n        // 属性节点\n        if (elem.nodeType === 2) {\n            let name = elem.name === 'class'? 'className': elem.name;\n            elem.ownerElement[name] = newVal;\n        }\n        // 文本节点\n        if (elem.nodeType === 3) {\n            elem.textContent = newVal;\n        }\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/dom.js","export default function(obj, exp) {\r\n    // 统一处理点号和方括号\r\n    let keySplit = exp.split('.'), result;\r\n    if (keySplit.length === 1) {\r\n        result = obj[exp];\r\n    } else {\r\n        let resultStr = 'obj';\r\n        for (let i = 0,len = keySplit.length;i < len;i++) {\r\n            resultStr += '.' + keySplit[i];\r\n        }\r\n        result = eval(resultStr);\r\n    }\r\n    return result;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/expression.js","var toString = Object.prototype.toString;\r\nexport default function(obj) {\r\n    return toString.call(obj);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/var/toString.js","export default function(str) {\r\n    return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/var/regEscape.js"],"sourceRoot":""}