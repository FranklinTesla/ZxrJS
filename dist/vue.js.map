{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap ae4ad2af18ca93559812","webpack:///./src/index.js","webpack:///./src/zxr.js","webpack:///./src/initComponent.js","webpack:///./src/watcher.js","webpack:///./src/dep.js"],"names":["module","exports","Zxr","options","Error","el","document","querySelector","$data","data","_watchers","__defineReactive","__walker","initComponent","trimToken","str","replace","prototype","__insertVal","txt","elem","rule","matchResult","match","keys","forEach","item","push","i","len","length","key","RegExp","result","attrs","attributes","childNodes","parseFn","arrayLike","nodeType","name","ownerElement","value","textNode","createTextNode","textContent","parentNode","replaceChild","Object","dep","val","defineProperty","get","target","depend","set","newVal","notify","uid","Watcher","vm","id","originElem","originVal","nodeValue","ownner","setAttribute","innerHTML","addSub","Dep","subs","sub","removeSub","$remove","addDep","l","update"],"mappings":"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","file":"vue.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Vue\"] = factory();\n\telse\n\t\troot[\"Vue\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ae4ad2af18ca93559812","import {Zxr} from './zxr';\r\nimport {initComponent} from './initComponent';\r\ninitComponent(Zxr);\r\n// 全局出口\r\nmodule.exports = Zxr;\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/**\r\n * Zxr实例构造函数\r\n * @param options\r\n * @constructor\r\n */\r\nfunction Zxr(options) {\r\n    if (options == null) throw new Error('an object param named must be pass in!');\r\n    let el = options.el;\r\n    el = document.querySelector(el);\r\n    this.$data = options.data;\r\n    this._watchers = [];\r\n    // 添加响应\r\n    this.__defineReactive();\r\n    // 编译模板\r\n    this.__walker(el);\r\n}\r\nexport {Zxr};\n\n\n// WEBPACK FOOTER //\n// ./src/zxr.js","import {Watcher} from './watcher';\r\nimport {Dep} from './dep';\r\nexport function initComponent(Zxr) {\r\n    function trimToken(str) {\r\n        return str.replace(/\\s*\\{\\s*\\{\\s*/g, '')\r\n            .replace(/\\s*}\\s*}\\s*/g, '');\r\n    };\r\n    /**\r\n     * 插值处理函数\r\n     * 将字符串中的{{xx}}替换为实际的值\r\n     */\r\n    Zxr.prototype.__insertVal = function(txt, elem) {\r\n        let rule = /\\{\\{\\s*(\\w+)\\s*}}/g,\r\n            matchResult = txt.match(rule),\r\n            data = this.$data;\r\n        if (!matchResult) return txt;\r\n        let keys = [];\r\n        matchResult.forEach(function(item) {\r\n            keys.push(trimToken(item));\r\n        });\r\n        for (let i = 0,len = keys.length;i < len;i++) {\r\n            let key = keys[i],\r\n                rule = new RegExp('\\\\{\\\\{\\\\s*('+key+'+)\\\\s*}}');\r\n            let result = key in data? data[key]: '';\r\n            txt = txt.replace(rule, result);\r\n            // 对所有插值语句创建watcher\r\n            // let watcher = new Watcher(this, elem, key);\r\n        }\r\n        return txt;\r\n    };\r\n    /**\r\n     * 节点遍历处理函数\r\n     */\r\n    Zxr.prototype.__walker = function(el) {\r\n        let attrs = el.attributes,\r\n            childNodes = el.childNodes;\r\n        let parseFn = (arrayLike) => {\r\n            for(let i = 0,len = arrayLike.length;i < len;i++) {\r\n                let item = arrayLike[i];\r\n                // 属性节点\r\n                if (item.nodeType === 2) {\r\n                    let name = item.name === 'class'? 'className': item.name;\r\n                    item.ownerElement[name] = this.__insertVal(item.value, item);\r\n                }\r\n                // 文本节点\r\n                if (item.nodeType === 3) {\r\n                    let textNode = document.createTextNode(this.__insertVal(item.textContent, item));\r\n                    item.parentNode.replaceChild(textNode, item);\r\n                }\r\n                // 递归处理element节点和document节点\r\n                if (item.nodeType === 1 || item.nodeType === 9) this.__walker(item);\r\n            }\r\n        };\r\n        // 遍历属性处理属性插值\r\n        if (attrs.length > 0) parseFn(attrs);\r\n        // 遍历子节点，处理节点插值\r\n        if (childNodes.length > 0) parseFn(childNodes);\r\n    };\r\n    /**\r\n     * 为data对象添加响应\r\n     */\r\n    Zxr.prototype.__defineReactive = function() {\r\n        let data = this.$data;\r\n        let keys = Object.keys(data);\r\n        for (let i = 0,len = keys.length;i < len;i++) {\r\n            let key = keys[i],\r\n                dep = new Dep(),\r\n                val = data[key];\r\n            Object.defineProperty(data, key ,{\r\n                get: function() {\r\n                    if (Dep.target) {\r\n                        dep.depend();\r\n                    }\r\n                    return val;\r\n                },\r\n                set: function(newVal) {\r\n                    dep.notify(newVal);\r\n                }\r\n            })\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/initComponent.js","import {Dep} from './dep';\r\nlet uid = 0;\r\nexport class Watcher {\r\n    constructor(vm, elem, key) {\r\n        this.id = uid++;\r\n        this.originElem = elem;\r\n        this.key = key;\r\n        vm._watchers.push(this);\r\n        Dep.target = this;\r\n        this.value = vm.$data[key];\r\n        Dep.target = null;\r\n    }\r\n    update(newVal) {\r\n        let elem = this.originElem,\r\n            rule = new RegExp('\\\\{\\\\{\\\\s*('+this.key+'+)\\\\s*}}');\r\n        this.originVal = elem.textContent;\r\n        let nodeValue = this.originVal.replace(rule, newVal);\r\n        // 属性节点\r\n        if (elem.nodeType === 2) {\r\n            this.ownner = elem.ownerElement;\r\n            elem.ownerElement.setAttribute(elem.name, nodeValue);\r\n        }\r\n        // 文本节点\r\n        if (elem.nodeType === 3) {\r\n            this.ownner = elem.parentNode;\r\n            elem.parentNode.innerHTML = nodeValue;\r\n        }\r\n        this.originElem = elem;\r\n    }\r\n    addDep(dep){\r\n        dep.addSub(this);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/watcher.js","let uid = 0;\r\nexport class Dep {\r\n    constructor() {\r\n        this.id = uid++;\r\n        this.subs = [];\r\n    }\r\n}\r\n\r\nDep.target = null;\r\n/**\r\n * Add a directive subscriber.\r\n *\r\n * @param {Directive} sub\r\n */\r\n\r\nDep.prototype.addSub = function (sub) {\r\n    this.subs.push(sub)\r\n}\r\n\r\n/**\r\n * Remove a directive subscriber.\r\n *\r\n * @param {Directive} sub\r\n */\r\n\r\nDep.prototype.removeSub = function (sub) {\r\n    this.subs.$remove(sub)\r\n}\r\n\r\n/**\r\n * Add self as a dependency to the target watcher.\r\n */\r\n\r\nDep.prototype.depend = function () {\r\n    Dep.target.addDep(this)\r\n}\r\n\r\n/**\r\n * Notify all subscribers of a new value.\r\n */\r\n\r\nDep.prototype.notify = function (newVal) {\r\n    // stablize the subscriber list first\r\n    var subs = this.subs\r\n    for (var i = 0, l = subs.length; i < l; i++) {\r\n        subs[i].update(newVal);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/dep.js"],"sourceRoot":""}