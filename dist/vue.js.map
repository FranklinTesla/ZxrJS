{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap eca8d8d4ca1e7e5ea51f","webpack:///./src/index.js","webpack:///./src/zxr.js","webpack:///./src/initComponent.js","webpack:///./src/watcher.js","webpack:///./src/dep.js","webpack:///./src/dom.js"],"names":["module","exports","Zxr","options","Error","el","document","querySelector","$data","data","_watchers","__defineReactive","$compile","initComponent","trimToken","str","replace","prototype","_compileSingleNode","elem","nodeValue","textContent","rule","matchResult","match","watchers","keys","forEach","item","push","i","len","length","key","RegExp","result","updateNode","watcher","attrs","attributes","childNodes","parseFn","arrayLike","nodeType","Object","dep","val","defineProperty","get","target","depend","set","newVal","notify","uid","Watcher","vm","id","value","lastValue","ownner","ownerElement","parentNode","addSub","Dep","subs","sub","removeSub","$remove","addDep","console","log","l","update","Dom","name","textNode","createTextNode","replaceChild"],"mappings":"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","file":"vue.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Vue\"] = factory();\n\telse\n\t\troot[\"Vue\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap eca8d8d4ca1e7e5ea51f","import {Zxr} from './zxr';\r\nimport {initComponent} from './initComponent';\r\ninitComponent(Zxr);\r\n// 全局出口\r\nmodule.exports = Zxr;\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/**\r\n * Zxr实例构造函数\r\n * @param options\r\n * @constructor\r\n */\r\nfunction Zxr(options) {\r\n    if (options == null) throw new Error('an object param named must be pass in!');\r\n    let el = options.el;\r\n    el = document.querySelector(el);\r\n    this.$data = options.data;\r\n    this._watchers = [];\r\n    // 添加响应\r\n    this.__defineReactive();\r\n    // 编译模板\r\n    this.$compile(el);\r\n}\r\nexport {Zxr};\n\n\n// WEBPACK FOOTER //\n// ./src/zxr.js","import {Watcher} from './watcher';\r\nimport {Dep} from './dep';\r\nimport {Dom} from './dom';\r\nexport function initComponent(Zxr) {\r\n    function trimToken(str) {\r\n        return str.replace(/\\s*\\{\\s*\\{\\s*/g, '')\r\n            .replace(/\\s*}\\s*}\\s*/g, '');\r\n    };\r\n    /**\r\n     * 编译具体节点\r\n     * 将文本节点和属性节点中的{{xx}}替换为实际的值\r\n     */\r\n    Zxr.prototype._compileSingleNode = function(elem) {\r\n        let nodeValue = elem.textContent,\r\n            rule = /\\{\\{\\s*(\\w+)\\s*}}/g,\r\n            matchResult = nodeValue.match(rule),\r\n            data = this.$data,\r\n            watchers = [];\r\n\r\n        if (!matchResult) return;\r\n        let keys = [];\r\n\r\n        matchResult.forEach(function(item) {\r\n            keys.push(trimToken(item));\r\n        });\r\n\r\n        for (let i = 0,len = keys.length;i < len;i++) {\r\n            let key = keys[i],\r\n                rule = new RegExp('\\\\{\\\\{\\\\s*('+key+'+)\\\\s*}}');\r\n            let result = key in data? data[key]: '';\r\n            // 对所有插值语句创建watcher\r\n            watchers.push(new Watcher(this, key));\r\n            nodeValue = nodeValue.replace(rule, result);\r\n        }\r\n        // 更新节点\r\n        elem = Dom.updateNode(elem, nodeValue);\r\n        watchers.forEach(function(watcher) {\r\n            watcher.elem = elem;\r\n        });\r\n    };\r\n    /**\r\n     * 节点遍历处理函数\r\n     */\r\n    Zxr.prototype.$compile = function(el) {\r\n        let attrs = el.attributes,\r\n            childNodes = el.childNodes;\r\n        let parseFn = (arrayLike) => {\r\n            for(let i = 0,len = arrayLike.length;i < len;i++) {\r\n                let item = arrayLike[i];\r\n                // 递归处理element节点和document节点\r\n                if (item.nodeType === 1 || item.nodeType === 9) {\r\n                    this.$compile(item);\r\n                } else {\r\n                    this._compileSingleNode(item);\r\n                }\r\n            }\r\n        };\r\n        // 遍历属性处理属性插值\r\n        if (attrs.length > 0) parseFn(attrs);\r\n        // 遍历子节点，处理节点插值\r\n        if (childNodes.length > 0) parseFn(childNodes);\r\n    };\r\n    /**\r\n     * 为data对象添加响应\r\n     */\r\n    Zxr.prototype.__defineReactive = function() {\r\n        let data = this.$data;\r\n        let keys = Object.keys(data);\r\n        for (let i = 0,len = keys.length;i < len;i++) {\r\n            let key = keys[i],\r\n                dep = new Dep(),\r\n                val = data[key];\r\n            Object.defineProperty(data, key ,{\r\n                get: function() {\r\n                    if (Dep.target) {\r\n                        dep.depend();\r\n                    }\r\n                    return val;\r\n                },\r\n                set: function(newVal) {\r\n                    dep.notify(newVal);\r\n                }\r\n            })\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/initComponent.js","import {Dep} from './dep';\r\nimport {Dom} from './dom';\r\nlet uid = 0;\r\nexport class Watcher {\r\n    constructor(vm, key) {\r\n        this.id = uid++;\r\n        this.key = key;\r\n        vm._watchers.push(this);\r\n        Dep.target = this;\r\n        this.value = vm.$data[key];\r\n        Dep.target = null;\r\n    }\r\n    update(newVal) {\r\n        let elem = this.elem,\r\n            lastValue = this.value,\r\n            nodeValue = elem.textContent;\r\n        let rule = new RegExp(lastValue, 'g');\r\n        this.ownner = elem.ownerElement || elem.parentNode;\r\n        if (!this.ownner) return;\r\n        this.value =\r\n        nodeValue = nodeValue.replace(rule, newVal);\r\n        this.elem = elem = Dom.updateNode(elem, nodeValue);\r\n    }\r\n    addDep(dep){\r\n        dep.addSub(this);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/watcher.js","let uid = 0;\r\nexport class Dep {\r\n    constructor() {\r\n        this.id = uid++;\r\n        this.subs = [];\r\n    }\r\n}\r\n\r\nDep.target = null;\r\n/**\r\n * Add a directive subscriber.\r\n *\r\n * @param {Directive} sub\r\n */\r\n\r\nDep.prototype.addSub = function (sub) {\r\n    this.subs.push(sub)\r\n}\r\n\r\n/**\r\n * Remove a directive subscriber.\r\n *\r\n * @param {Directive} sub\r\n */\r\n\r\nDep.prototype.removeSub = function (sub) {\r\n    this.subs.$remove(sub)\r\n}\r\n\r\n/**\r\n * Add self as a dependency to the target watcher.\r\n */\r\n\r\nDep.prototype.depend = function () {\r\n    Dep.target.addDep(this)\r\n}\r\n\r\n/**\r\n * Notify all subscribers of a new value.\r\n */\r\n\r\nDep.prototype.notify = function (newVal) {\r\n    // stablize the subscriber list first\r\n    var subs = this.subs\r\n    console.log(subs)\r\n    for (var i = 0, l = subs.length; i < l; i++) {\r\n        subs[i].update(newVal);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/dep.js","export let Dom = {\r\n    updateNode: (elem, newVal) => {\r\n        let nodeValue = elem.textContent;\r\n        if (nodeValue === newVal) {\r\n            return elem;\r\n        }\r\n        // 属性节点\r\n        if (elem.nodeType === 2) {\r\n            let name = elem.name === 'class'? 'className': elem.name;\r\n            elem.ownerElement[name] = newVal;\r\n        }\r\n        // 文本节点\r\n        if (elem.nodeType === 3) {\r\n            let textNode = document.createTextNode(newVal);\r\n            elem.parentNode.replaceChild(textNode, elem);\r\n            // 注意elem引用的改变\r\n            elem = textNode;\r\n        }\r\n        return elem;\r\n    }\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/dom.js"],"sourceRoot":""}