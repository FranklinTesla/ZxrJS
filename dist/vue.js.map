{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap af2a9f47c5ebfa008fc1","webpack:///./src/index.js","webpack:///./src/zxr.js","webpack:///./src/initComponent.js","webpack:///./src/watcher.js","webpack:///./src/dep.js","webpack:///./src/dom.js"],"names":["module","exports","Zxr","options","Error","el","document","querySelector","$data","data","_watchers","__defineReactive","$compile","initComponent","trimToken","str","replace","prototype","_compileSingleNode","elem","nodeValue","textContent","value","rule","matchResult","match","watchers","keys","forEach","item","push","i","len","length","key","RegExp","result","updateNode","attrs","attributes","childNodes","parseFn","arrayLike","nodeType","Object","dep","val","defineProperty","get","target","depend","set","newVal","notify","uid","Watcher","vm","id","lastValue","addSub","Dep","subs","sub","removeSub","$remove","addDep","l","update","Dom","name","ownerElement"],"mappings":"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","file":"vue.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Vue\"] = factory();\n\telse\n\t\troot[\"Vue\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap af2a9f47c5ebfa008fc1","import {Zxr} from './zxr';\nimport {initComponent} from './initComponent';\ninitComponent(Zxr);\n// 全局出口\nmodule.exports = Zxr;\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/**\n * Zxr实例构造函数\n * @param options\n * @constructor\n */\nfunction Zxr(options) {\n    if (options == null) throw new Error('an object param named must be pass in!');\n    let el = options.el;\n    el = document.querySelector(el);\n    this.$data = options.data;\n    this._watchers = [];\n    // 添加响应\n    this.__defineReactive();\n    // 编译模板\n    this.$compile(el);\n}\nexport {Zxr};\n\n\n// WEBPACK FOOTER //\n// ./src/zxr.js","import {Watcher} from './watcher';\nimport {Dep} from './dep';\nimport {Dom} from './dom';\nexport function initComponent(Zxr) {\n    function trimToken(str) {\n        return str.replace(/\\s*\\{\\s*\\{\\s*/g, '')\n            .replace(/\\s*}\\s*}\\s*/g, '');\n    };\n    /**\n     * 编译具体节点\n     * 将文本节点和属性节点中的{{xx}}替换为实际的值\n     */\n    Zxr.prototype._compileSingleNode = function(elem) {\n        let nodeValue = elem.textContent || elem.value,\n            rule = /\\{\\s*\\{\\s*(\\w+)\\s*}\\s*}/g,\n            matchResult = nodeValue.match(rule),\n            data = this.$data,\n            watchers = [];\n\n        if (!matchResult) return;\n        let keys = [];\n\n        matchResult.forEach(function(item) {\n            keys.push(trimToken(item));\n        });\n\n        for (let i = 0,len = keys.length;i < len;i++) {\n            let key = keys[i],\n                rule = new RegExp('\\\\{\\\\s*\\\\{\\\\s*('+key+'+)\\\\s*}\\\\s*}');\n            let result = key in data? data[key]: '';\n            // 对所有插值语句创建watcher\n            watchers.push(new Watcher(this, elem, key));\n            nodeValue = nodeValue.replace(rule, result);\n        }\n        // 更新节点\n        Dom.updateNode(elem, nodeValue);\n    };\n    /**\n     * 节点遍历处理函数\n     */\n    Zxr.prototype.$compile = function(el) {\n        let attrs = el.attributes,\n            childNodes = el.childNodes;\n        let parseFn = (arrayLike) => {\n            for(let i = 0,len = arrayLike.length;i < len;i++) {\n                let item = arrayLike[i];\n                // 递归处理element节点和document节点\n                if (item.nodeType === 1 || item.nodeType === 9) {\n                    this.$compile(item);\n                } else {\n                    this._compileSingleNode(item);\n                }\n            }\n        };\n        // 遍历属性处理属性插值\n        if (attrs.length > 0) parseFn(attrs);\n        // 遍历子节点，处理节点插值\n        if (childNodes.length > 0) parseFn(childNodes);\n    };\n    /**\n     * 为data对象添加响应\n     */\n    Zxr.prototype.__defineReactive = function() {\n        let data = this.$data;\n        let keys = Object.keys(data);\n        for (let i = 0,len = keys.length;i < len;i++) {\n            let key = keys[i],\n                dep = new Dep(),\n                val = data[key];\n            Object.defineProperty(data, key ,{\n                get: function() {\n                    if (Dep.target) {\n                        dep.depend();\n                    }\n                    return val;\n                },\n                set: function(newVal) {\n                    if (newVal === val) {\n                        return;\n                    }\n                    dep.notify(newVal);\n                }\n            })\n        }\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/initComponent.js","import {Dep} from './dep';\nimport {Dom} from './dom';\nlet uid = 0;\nexport class Watcher {\n    constructor(vm, elem, key) {\n        this.id = uid++;\n        this.key = key;\n        this.vm = vm;\n        this.elem = elem;\n        vm._watchers.push(this);\n        Dep.target = this;\n        this.value = vm.$data[key];\n        Dep.target = null;\n    }\n    update(newVal) {\n        let lastValue = this.value;\n        if (newVal === lastValue) {\n            return;\n        }\n        // 处理文本节点\n        let elem = this.elem,\n            nodeValue = elem.textContent;\n        this.value = newVal;\n        nodeValue = nodeValue.replace(lastValue, newVal);\n        Dom.updateNode(elem, nodeValue);\n    }\n    addDep(dep){\n        dep.addSub(this);\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/watcher.js","let uid = 0;\nexport class Dep {\n    constructor() {\n        this.id = uid++;\n        this.subs = [];\n    }\n}\n\nDep.target = null;\n/**\n * Add a directive subscriber.\n *\n * @param {Directive} sub\n */\n\nDep.prototype.addSub = function (sub) {\n    this.subs.push(sub)\n}\n\n/**\n * Remove a directive subscriber.\n *\n * @param {Directive} sub\n */\n\nDep.prototype.removeSub = function (sub) {\n    this.subs.$remove(sub)\n}\n\n/**\n * Add self as a dependency to the target watcher.\n */\n\nDep.prototype.depend = function () {\n    Dep.target.addDep(this)\n}\n\n/**\n * Notify all subscribers of a new value.\n */\n\nDep.prototype.notify = function (newVal) {\n    // stablize the subscriber list first\n    var subs = this.subs\n    for (var i = 0, l = subs.length; i < l; i++) {\n        subs[i].update(newVal);\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/dep.js","export let Dom = {\n    updateNode: (elem, newVal) => {\n        let nodeValue = elem.textContent;\n        if (nodeValue === newVal) {\n            return elem;\n        }\n        // 属性节点\n        if (elem.nodeType === 2) {\n            let name = elem.name === 'class'? 'className': elem.name;\n            elem.ownerElement[name] = newVal;\n        }\n        // 文本节点\n        if (elem.nodeType === 3) {\n            elem.textContent = newVal;\n        }\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/dom.js"],"sourceRoot":""}